<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="generator" content="Bootply" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <title>Lamar - Nested Containers (Per Request/Transaction)</title>
        <link href="/lamar/content/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/lamar/content/prism.css" rel="stylesheet" type="text/css" />
        <link href="/lamar/content/theme.css" rel="stylesheet" type="text/css" />

        <link rel="apple-touch-icon" href="/bootstrap/img/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/bootstrap/img/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/bootstrap/img/apple-touch-icon-114x114.png">

        <link href="/lamar/content/affix.css" rel="stylesheet" type="text/css" />
    </head>

    <body>

      <a href="https://github.com/jasperfx/Lamar"><img style="z-index: 5000; position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>

      <nav class="navbar navbar-default navbar-fixed-top" role="banner">
      <div class="container">
        <div class="navbar-header">
          <a href="/lamar" class="navbar-brand">Lamar</a>
        </div>
        <nav class="collapse navbar-collapse" role="navigation">
          <ul class="nav navbar-nav pull-right">
            <li>
              <a href="/lamar/getting_started">Getting Started</a>
            </li>
            <li>
              <a href="/lamar/documentation">Documentation</a>
            </li>
            <li>
              <a href="https://gitter.im/jasperfx/Lamar?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://camo.githubusercontent.com/da2edb525cde1455a622c58c0effc3a90b9a181c/68747470733a2f2f6261646765732e6769747465722e696d2f4a6f696e253230436861742e737667" alt="Join the chat at https://gitter.im/jasperfx/Lamar" data-canonical-src="https://badges.gitter.im/Join%20Chat.svg" style="max-width:100%;"></a>
            </li>
            <li><a href="/lamar/documentation/ioc/lazy-resolution" title="Lazy Resolution">Previous</a></li>
            <li><a href="/lamar/documentation/ioc/working-with-enumerable-types" title="Working with Enumerable Types">Next</a></li>
          </ul>
          <div class="navbar-form navbar-left" role="search">
            <div class="form-group">
              <input id="search" type="search" class="form-control" placeholder="Search">
            </div>
          </div>

        </nav>

      </div>
    </nav>

    <div class="container">
      <nav class="navbar-inverse">
        <ol class="breadcrumb"><li><a href="/lamar/">Lamar</a></li><li><a href="/lamar/documentation">Documentation</a></li><li><a href="/lamar/documentation/ioc">Lamar as IoC Container</a></li><li class="active">Nested Containers (Per Request/Transaction)</li></ol>
      </nav>
    </div>

    <!--main-->
    <div class="container">
      <div class="row">
          <!--left-->
          <div class="col-md-3" id="leftCol">
            <h3>Lamar 1.0.0</h3>
            <br />

            <ul class="nav nav-stacked affix" id="sidebar">
            </ul>

            <h3 class="no-margin">Next</h3><p><a href="/lamar/documentation/ioc/working-with-enumerable-types">Working with Enumerable Types</a></p>
            <h3 class="no-margin">Previous</h3><a href="/lamar/documentation/ioc/lazy-resolution">Lazy Resolution</a></p>
          </div><!--/left-->

          <!--right-->
          <div class="col-md-9">
              <h1>Nested Containers (Per Request/Transaction)</h1>

              <hr />

              <div id="main-pane">
                <!--Title: Nested Containers (Per Request/Transaction)-->
<div class="alert-info alert"><p><strong>Note!</strong>
If you're coming from StructureMap, do note that Lamar does not yet support the concept of &quot;child&quot; containers</p>
</div>
<p><em>Nested Container's</em> are a powerful feature in Lamar for service resolution and clean object disposal in the
context of short lived operations like HTTP requests or handling a message within some kind of service bus. A <em>nested container</em>
is specific to the scope of that operation and is should not live on outside of that scope.</p>
<p>Here's a sample of a nested container in action:</p>
<pre><code class="language-csharp">&#xA;[Fact]&#xA;public void using_nested_containers()&#xA;{&#xA;    var container = new Container(x =&gt;&#xA;    {&#xA;        x.AddSingleton&lt;IWidget, AWidget&gt;();&#xA;        x.AddScoped&lt;IService, WhateverService&gt;();&#xA;        x.AddTransient&lt;IClock, Clock&gt;();&#xA;    });&#xA;&#xA;    var rootWidget = container.GetInstance&lt;IWidget&gt;();&#xA;    var rootService = container.GetInstance&lt;IService&gt;();&#xA;&#xA;    var nested = container.GetNestedContainer();&#xA;    &#xA;    // Singleton scoped objects are the same&#xA;    nested.GetInstance&lt;IWidget&gt;()&#xA;        .ShouldBeSameAs(rootWidget);&#xA;    &#xA;    // Scoped objects are specific to the container&#xA;    var nestedService = nested.GetInstance&lt;IService&gt;();&#xA;    nestedService&#xA;        .ShouldNotBeSameAs(rootService);&#xA;    &#xA;    nested.GetInstance&lt;IService&gt;()&#xA;        .ShouldBeSameAs(nestedService);&#xA;}&#xA;</code></pre>
<p>You probably won't directly interact with nested containers, but do note that they are used behind the scenes at runtime of basically every
popular application framework in .Net these days (ASP.Net Core, NServiceBus, MassTransit, NancyFx, you name it).</p>

              </div>

              <hr />

              <nav>
                <span>
                  <strong>Previous: </strong><a href="/lamar/documentation/ioc/lazy-resolution">Lazy Resolution</a>

                </span>
                <span class="pull-right">

                  <strong>Next: </strong><a href="/lamar/documentation/ioc/working-with-enumerable-types">Working with Enumerable Types</a>

                </span>
              </nav>

          </div><!--/right-->
        </div><!--/row-->
      </div><!--/container-->

    </body>


    <footer>
        <script type='text/javascript' src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script type='text/javascript' src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <script type="text/javascript" src="/lamar/content/prism.js"></script>
        <script type="text/javascript" src="/lamar/content/sidebar.js"></script>
        <script type="text/javascript" src="/lamar/content/affix.js"></script>

<script>
$('#search').keyup(function(e){
  if(e.keyCode == 13) {
    var search = $('#search').val();

    var url = 'https://www.google.com/#q=site:jasperfx.github.io ' + search;
    url = encodeURI(url);

    window.location.href = url;

    e.stopPropagation();
    if (e.cancelBubble!=null) e.cancelBubble = true;
    return false;
  }
});
</script>
    </footer>
</html>
