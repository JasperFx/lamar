<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The &quot;Frame&quot; Model | Lamar</title>
    <meta name="description" content=".NET Fast Inversion of Control and Dynamic code weaving tools">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/lamar/assets/style.CnEDqSnK.css" as="style">
    <link rel="preload stylesheet" href="/lamar/vp-icons.css" as="style">
    
    <script type="module" src="/lamar/assets/app.BqZXBnA5.js"></script>
    <link rel="preload" href="/lamar/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/lamar/assets/chunks/theme.CH0AXjcd.js">
    <link rel="modulepreload" href="/lamar/assets/chunks/framework.B2AeMXkx.js">
    <link rel="modulepreload" href="/lamar/assets/guide_compilation_frames_index.md.CB7Voqbw.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/lamar/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>Lamar</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/lamar/guide/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/JasperFx/lamar/releases" target="_blank" rel="noreferrer" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Release Notes</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://discord.gg/WMxrvegf8H" target="_blank" rel="noreferrer" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Discord | Join Chat</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Getting Started</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>What is Lamar</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Inversion of Control</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Lamar as IoC Container</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/concepts.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Software Design Concepts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/bootstrapping.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Bootstrapping a Container</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/aspnetcore.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Integration with ASP.NET Core</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/blazor.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Integration with Blazor</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/registration/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Registration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/lifetime.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Service Lifetimes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/resolving/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Resolving Services</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/generics.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Generic Types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/decorators.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Decorators, Interceptors, and Activators</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/diagnostics/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Lamar Diagnostics</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/auto-wiring.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Auto Wiring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/lambdas.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Building Objects with Lambdas</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/injecting-at-runtime.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Injecting Services at Runtime</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/disposing.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Lamar, IDisposable, and IAsyncDisposable</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/lazy-resolution.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Lazy Resolution</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/nested-containers.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Nested Containers (Per Request/Transaction)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/setter-injection.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Setter Injection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/lamar/guide/ioc/working-with-enumerable-types.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Working with Enumerable Types</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _lamar_guide_compilation_frames_" data-v-39a288b8><div><h1 id="the-frame-model" tabindex="-1">The &quot;Frame&quot; Model <a class="header-anchor" href="#the-frame-model" aria-label="Permalink to &quot;The &quot;Frame&quot; Model&quot;">​</a></h1><p>The purpose of the &quot;frames&quot; model is to be able to generate dynamic methods by declaring a list of logical operations in generated code via Frame objects, then let Lamar handle:</p><ul><li>Finding any missing dependencies of those frames</li><li>Determine what the necessary variable inputs are</li><li>Ordering all the frames based on dependency order just prior to generating the code</li></ul><p>Before diving into an example, here&#39;s a little class diagram of the main types:</p><p><img src="/lamar/assets/LamarCodeGenClassDiagram.ONQ7CLKA.png" alt="The Code Generation Model"></p><p>The various types represent:</p><ul><li><code>Frame</code> - Named after the StackFrame objects within stack traces in .NET. Models a logical action done in the generated code. Concrete examples in Lamar or Jasper would be calling a method on an object, calling a constructor function, or specific frame objects to create wrapped transaction boundaries or exception handling boundaries.</li><li><code>Variable</code> - pretty well what it sounds like. This type models a variable within the generated method, but also includes information about what Frame created it to help order the dependencies</li><li><code>IVariableSource</code> - mechanism to &quot;find&quot; or create variables. Examples in Lamar include resolving a service from an IoC container, passing along a method argument, or the example below that tells you the current time</li><li><code>IMethodVariables</code> - interface that is used by Frame classes to go find their necessary Variable dependencies.</li></ul><p>Alright then, let&#39;s make this concrete. Let&#39;s say that we want to generate and use dynamic instances of this interface:</p><div class="language-cs vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ISaySomething</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Speak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Moreover, I want a version of <code>ISaySomething</code> that will call the following method and write the current time to the console:</p><div class="language-cs vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowSpeaker</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Speak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WriteLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(now.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ToString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;o&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Our dynamic class for ISaySomething will need to pass the current time to the now parameter of that method. To help out here, there&#39;s some built in helpers in Lamar specifically to write in the right code to get the current time to a variable of DateTime or DateTimeOffset that is named &quot;now.&quot;</p><p>To skip ahead a little bit, let&#39;s generate a new class and object with the following code:</p><div class="language-cs vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Configures the code generation rules</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// and policies</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rules</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GenerationRules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GeneratedNamespace&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Adds the &quot;now : DateTime&quot; variable rule to </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// our generated code</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rules.Sources.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowTimeVariableSource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Start the definition for a new generated assembly</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> assembly</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GeneratedAssembly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rules);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Add a new generated type called &quot;WhatTimeIsIt&quot; that will</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// implement the </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> assembly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WhatTimeIsIt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ISaySomething</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Getting the definition for the method named &quot;Speak&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> type.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MethodFor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nameof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ISaySomething.Speak));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Adding a frame that calls the NowSpeaker.Speak() method and</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// adding it to the generated method</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @call</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MethodCall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NowSpeaker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nameof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NowSpeaker.Speak));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">method.Frames.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@call);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Compile the new code!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">assembly.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CompileAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><p>After all that, if we interrogate the source code for the generated type above (type.SourceCode), we&#39;d see this ugly generated code:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WhatTimeIsIt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Lamar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Testing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Samples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ISaySomething</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Speak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> now</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> System.DateTime.UtcNow;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Lamar.Testing.Samples.NowSpeaker.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Speak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(now);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>Some notes about the generated code:</p><ul><li>Lamar was able to stick in some additional code to pass the current time into a new variable, and call the Speak(DateTime now) method with that value.</li><li>Lamar is smart enough to put that code before the call to the method (that kind of matters here)</li><li>The generated code uses full type names in almost all cases to avoid type collisions rather than trying to get smart with using statements in the generated code</li></ul><p>So now let&#39;s look at how Lamar was able to add the code to pass along DateTime.UtcNow. First off, let&#39;s look at the code that just writes out the date variable:</p><div class="language-cs vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowFetchFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SyncFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowFetchFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> variableType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Notice how &quot;this&quot; frame is passed into the variable</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // class constructor as the creator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Variable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Variable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(variableType, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;now&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Variable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GenerateCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GeneratedMethod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ISourceWriter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> writer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        writer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WriteLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$&quot;var {</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Usage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} = {</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VariableType</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FullName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nameof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DateTime</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UtcNow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)};&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Next</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GenerateCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(method, writer);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>In the frame above, you&#39;ll see that the <code>GenerateCode()</code> method writes its code into the source, then immediately turns around and tells the next Frame - if there is one - to generated its code. As the last step to write out the new source code, Lamar:</p><ol><li>Goes through an effort to find any missing frames and variables</li><li>Sorts them with a topological sort (what frames depend on what other frames or variables, what variables are used or created by what frames)</li><li>Organizes the frames into a single linked list</li><li>Calls <code>GenerateCode()</code> on the first frame</li></ol><p>In the generated method up above, the call to <code>NowSpeaker.Speak(now)</code> depends on the now variable which is in turn created by the <code>NowFetchFrame</code>, and that&#39;s enough information for Lamar to order things and generate the final code.</p><p>Lastly, we had to use a custom <code>IVariableSource</code> to teach Lamar how to resolve the now variable. That code looks like this:</p><div class="language-cs vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowTimeVariableSource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IVariableSource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Matches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTimeOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowFetchFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).Variable;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTimeOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NowFetchFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DateTimeOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).Variable;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArgumentOutOfRangeException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nameof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(type), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Only DateTime and DateTimeOffset are supported&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Out of the box, the Lamar + <a href="https://jasperfx.github.io" target="_blank" rel="noreferrer">Jasper</a> combination uses variable sources for:</p><ul><li>Services from the internal IoC container of the application</li><li>Method arguments</li><li>Variables that can be derived from a method argument like <code>HttpContext.Request : HttpRequest</code></li><li>The &quot;now&quot; convention shown here</li></ul><h2 id="generatedassembly-type-method" tabindex="-1">GeneratedAssembly/Type/Method <a class="header-anchor" href="#generatedassembly-type-method" aria-label="Permalink to &quot;GeneratedAssembly/Type/Method&quot;">​</a></h2><p>Getting a little deeper into the parts of the &quot;frames&quot; model, see this class diagram:</p><p><img src="/lamar/assets/GeneratedAssemblyModel.DlEmXi2b.png" alt="GeneratedAssembly Model"></p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/lamar/guide/" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>What is Lamar</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"guide_compilation_assembly-generator.md\":\"BO4yNRrE\",\"guide_compilation_frames_extension-methods.md\":\"Cr08iMBC\",\"guide_compilation_frames_frame.md\":\"ehqzhZb4\",\"guide_compilation_frames_index.md\":\"CB7Voqbw\",\"guide_compilation_frames_injected-fields.md\":\"uDLmj7mQ\",\"guide_compilation_frames_variables.md\":\"C0UqaQmr\",\"guide_compilation_index.md\":\"DO5yFNKP\",\"guide_compilation_source-writer.md\":\"DmaFS_yH\",\"guide_index.md\":\"lXc6eUv0\",\"guide_ioc_aspnetcore.md\":\"2p4tcF93\",\"guide_ioc_auto-wiring.md\":\"DtyouIC2\",\"guide_ioc_blazor.md\":\"CDmQoIQA\",\"guide_ioc_bootstrapping.md\":\"vXKhsQfO\",\"guide_ioc_concepts.md\":\"hu7Ac-Fp\",\"guide_ioc_decorators.md\":\"CcecmKX0\",\"guide_ioc_diagnostics_build-plans.md\":\"C_44sVzO\",\"guide_ioc_diagnostics_environment-tests.md\":\"DD_MlbHP\",\"guide_ioc_diagnostics_index.md\":\"sWKuZJ9D\",\"guide_ioc_diagnostics_type-scanning.md\":\"CJbvCItG\",\"guide_ioc_diagnostics_using-the-container-model.md\":\"DiQ7gGwd\",\"guide_ioc_diagnostics_validating-container-configuration.md\":\"DiHknPnO\",\"guide_ioc_diagnostics_what-do-i-have.md\":\"DKxX1mLn\",\"guide_ioc_disposing.md\":\"1y8rOFQj\",\"guide_ioc_generics.md\":\"DxXbLF2r\",\"guide_ioc_index.md\":\"CfBJYWlv\",\"guide_ioc_injecting-at-runtime.md\":\"BttZg1kK\",\"guide_ioc_lambdas.md\":\"B0bwXutE\",\"guide_ioc_lazy-resolution.md\":\"CRpKkuXa\",\"guide_ioc_lifetime.md\":\"Hy7r5yeb\",\"guide_ioc_nested-containers.md\":\"BKfTwtki\",\"guide_ioc_registration_attributes.md\":\"DaWBA3KM\",\"guide_ioc_registration_auto-registration-and-conventions.md\":\"DRjjlQoW\",\"guide_ioc_registration_changing-configuration-at-runtime.md\":\"CvX_e-bI\",\"guide_ioc_registration_configured-instance.md\":\"DFOXM_GC\",\"guide_ioc_registration_constructor-selection.md\":\"C-uSzVfL\",\"guide_ioc_registration_existing-objects.md\":\"C-D6J46x\",\"guide_ioc_registration_index.md\":\"iDBOcSAh\",\"guide_ioc_registration_inline-dependencies.md\":\"DJRGgnQf\",\"guide_ioc_registration_overrides.md\":\"CXwXripr\",\"guide_ioc_registration_policies.md\":\"DMF6OX1x\",\"guide_ioc_registration_registry-dsl.md\":\"Ci6q_96G\",\"guide_ioc_resolving_get-a-service-by-plugin-type-and-name.md\":\"w1g0ULYz\",\"guide_ioc_resolving_get-a-service-by-service-type.md\":\"Zxuey_eq\",\"guide_ioc_resolving_get-all-services-by-service-type.md\":\"DuEve47a\",\"guide_ioc_resolving_index.md\":\"qxKKzGKc\",\"guide_ioc_resolving_requesting-a-concrete-type.md\":\"CDX9bRN1\",\"guide_ioc_resolving_try-getting-an-optional-service-by-service-type-and-name.md\":\"D1moDDA5\",\"guide_ioc_resolving_try-getting-an-optional-service-by-service-type.md\":\"DYHQIp0H\",\"guide_ioc_setter-injection.md\":\"DWG9jJ9S\",\"guide_ioc_working-with-enumerable-types.md\":\"BX-JSmqt\",\"index.md\":\"DJPVxN8O\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Lamar\",\"description\":\".NET Fast Inversion of Control and Dynamic code weaving tools\",\"base\":\"/lamar/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":null,\"repo\":\"JasperFx/lamar\",\"docsDir\":\"docs\",\"docsBranch\":\"master\",\"editLinks\":true,\"editLinkText\":\"Suggest changes to this page\",\"nav\":[{\"text\":\"Guide\",\"link\":\"/guide/\"},{\"text\":\"Release Notes\",\"link\":\"https://github.com/JasperFx/lamar/releases\"},{\"text\":\"Discord | Join Chat\",\"link\":\"https://discord.gg/WMxrvegf8H\"}],\"search\":{\"provider\":\"local\"},\"sidebar\":{\"/\":[{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"What is Lamar\",\"link\":\"/guide/\"}]},{\"text\":\"Inversion of Control\",\"collapsed\":false,\"items\":[{\"text\":\"Lamar as IoC Container\",\"link\":\"/guide/ioc/\"},{\"text\":\"Software Design Concepts\",\"link\":\"/guide/ioc/concepts\"},{\"text\":\"Bootstrapping a Container\",\"link\":\"/guide/ioc/bootstrapping\"},{\"text\":\"Integration with ASP.NET Core\",\"link\":\"/guide/ioc/aspnetcore\"},{\"text\":\"Integration with Blazor\",\"link\":\"/guide/ioc/blazor\"},{\"text\":\"Registration\",\"link\":\"/guide/ioc/registration/\",\"children\":[{\"text\":\"ServiceRegistry DSL\",\"link\":\"/guide/ioc/registration/registry-dsl\"},{\"text\":\"Inline Dependencies\",\"link\":\"/guide/ioc/registration/inline-dependencies\"},{\"text\":\"Auto-Registration and Conventions\",\"link\":\"/guide/ioc/registration/auto-registration-and-conventions\"},{\"text\":\"Working with IConfiguredInstance\",\"link\":\"/guide/ioc/registration/configured-instance\"},{\"text\":\"Policies\",\"link\":\"/guide/ioc/registration/policies\"},{\"text\":\"Changing Configuration at Runtime\",\"link\":\"/guide/ioc/registration/changing-configuration-at-runtime\"},{\"text\":\"Constructor Selection\",\"link\":\"/guide/ioc/registration/constructor-selection\"},{\"text\":\"Registering Existing Objects\",\"link\":\"/guide/ioc/registration/existing-objects\"},{\"text\":\"Using Attributes for Configuration\",\"link\":\"/guide/ioc/registration/attributes\"},{\"text\":\"Overriding Service Registrations\",\"link\":\"/guide/ioc/registration/overrides\"}]},{\"text\":\"Service Lifetimes\",\"link\":\"/guide/ioc/lifetime\"},{\"text\":\"Resolving Services\",\"link\":\"/guide/ioc/resolving/\",\"children\":[{\"text\":\"Get a Service by Service Type\",\"link\":\"/guide/ioc/resolving/get-a-service-by-service-type\"},{\"text\":\"Get a Service by Service Type and Name\",\"link\":\"/guide/ioc/resolving/get-a-service-by-service-type-and-name\"},{\"text\":\"Get all Services by Service Type\",\"link\":\"/guide/ioc/resolving/get-all-services-by-service-type\"},{\"text\":\"Try Getting an Optional Service by Service Type\",\"link\":\"/guide/ioc/resolving/try-getting-an-optional-service-by-service-type\"},{\"text\":\"Try Getting an Optional Service by Service Type and Name\",\"link\":\"/guide/ioc/resolving/try-getting-an-optional-service-by-service-type-and-name\"},{\"text\":\"Auto Resolving Concrete Types\",\"link\":\"/guide/ioc/resolving/requesting-a-concrete-type\"}]},{\"text\":\"Generic Types\",\"link\":\"/guide/ioc/generics\"},{\"text\":\"Decorators, Interceptors, and Activators\",\"link\":\"/guide/ioc/decorators\"},{\"text\":\"Lamar Diagnostics\",\"link\":\"/guide/ioc/diagnostics/\",\"children\":[{\"text\":\"WhatDoIHave()\",\"link\":\"/guide/ioc/diagnostics/what-do-i-have\"},{\"text\":\"Validating Container Configuration\",\"link\":\"/guide/ioc/diagnostics/validating-container-configuration\"},{\"text\":\"Environment Tests\",\"link\":\"/guide/ioc/diagnostics/environment-tests\"},{\"text\":\"Build Plans\",\"link\":\"/guide/ioc/diagnostics/build-plans\"},{\"text\":\"Using the Container Model\",\"link\":\"/guide/ioc/diagnostics/using-the-container-model\"},{\"text\":\"Type Scanning Diagnostics\",\"link\":\"/guide/ioc/diagnostics/type-scanning\"}]},{\"text\":\"Auto Wiring\",\"link\":\"/guide/ioc/auto-wiring\"},{\"text\":\"Building Objects with Lambdas\",\"link\":\"/guide/ioc/lambdas\"},{\"text\":\"Injecting Services at Runtime\",\"link\":\"/guide/ioc/injecting-at-runtime\"},{\"text\":\"Lamar, IDisposable, and IAsyncDisposable\",\"link\":\"/guide/ioc/disposing\"},{\"text\":\"Lazy Resolution\",\"link\":\"/guide/ioc/lazy-resolution\"},{\"text\":\"Nested Containers (Per Request/Transaction)\",\"link\":\"/guide/ioc/nested-containers\"},{\"text\":\"Setter Injection\",\"link\":\"/guide/ioc/setter-injection\"},{\"text\":\"Working with Enumerable Types\",\"link\":\"/guide/ioc/working-with-enumerable-types\"}]}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>